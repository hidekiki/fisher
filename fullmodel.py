import numpy as np
from fishfun import P, qmin, qmax, Fshape, allparam, T

param = allparam # ugly but no choice for now

###### power spectrum ######
def P_integrand(k,q,x,(fnlfid ,b10fid, b20fid, b01fid, b11fid, b02fid, chi1fid, w10fid, sigfid, Rfid)):
    return (0.002551020408163265*((196.*(1. + b10fid + b01fid*k**2)**2*P(k))/(qmax - 1.*qmin) + (0.10132118364233778*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(2.*q*Rfid**2*(q - 1.*k*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2))


###### bispectrum ######
def B_integrand(k,q,x,(fnlfid ,b10fid, b20fid, b01fid, b11fid, b02fid, chi1fid, w10fid, sigfid, Rfid)):
    return (0.008414,(0.017857142857142856*(((1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*(-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 14.*k[0]**6*(1.*b01fid - 1.5*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*((6. + 14.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + k[1]**4*(14.*b01fid + 28.*b11fid + 28.*chi1fid - 42.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[0]**2*k[1]**2) + ((1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[2]**2)*(2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 14.*k[0]**6*(1.*b01fid - 1.5*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + k[1]**2*(6. + 14.*b10fid - 28.*chi1fid*k[2]**2 - 42.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[0]**2*k[2]**2) - (14.*(1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*(k[2]**4*(0.7142857142857143 + 1.*b10fid + 1.*b01fid*k[2]**2) + k[1]**6*(1.*b01fid - 1.5*k[2]**2*w10fid) + k[0]**4*(-0.2857142857142857 - 1.5*k[1]**2*k[2]**2*w10fid) + k[1]**2*k[2]**2*(-1.4285714285714286 - 2.*b10fid - 2.*b20fid - 1.*b01fid*k[2]**2 - 2.*b11fid*k[2]**2 - 2.*chi1fid*k[2]**2 - 1.5*k[2]**4*w10fid) + k[1]**4*(0.7142857142857143 + 1.*b10fid - 1.*b01fid*k[2]**2 - 2.*b11fid*k[2]**2 - 2.*chi1fid*k[2]**2 - 2.*b02fid*k[2]**4 - 1.*k[2]**4*w10fid) + k[0]**2*(k[2]**2*(-0.42857142857142855 - 1.*b10fid - 1.*b01fid*k[2]**2) + k[1]**4*(-1.*b01fid + 3.*k[2]**2*w10fid) + k[1]**2*(-0.42857142857142855 - 1.*b10fid + 2.*chi1fid*k[2]**2 + 3.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2*k[2]**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)))

###### power spectrum derivative ######
def DP_integrand(k,q,x,(fnlfid ,b10fid, b20fid, b01fid, b11fid, b02fid, chi1fid, w10fid, sigfid, Rfid),par):
    return np.asarray(((0.0036186137015120634*2.718281828459045**(-1.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + k*q*Rfid**2*x)*(1. + b10fid + b01fid*k**2)*q*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*Fshape(q,np.sqrt(k**2 + q**2 - 2.*k*q*x),k))/(k**2 + q**2 - 2.*k*q*x),(0.03571428571428571*((28.*(1. + b10fid + b01fid*k**2)*P(k))/(qmax - 1.*qmin) + (0.10132118364233778*k**2*(q + k*x - 2.*q*x**2)*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(2.*q*Rfid**2*(q - 1.*k*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2)),(0.0036186137015120634*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),(0.03571428571428571*k**2*((28.*(1. + b10fid + b01fid*k**2)*P(k))/(qmax - 1.*qmin) + (0.10132118364233778*(k**3*x - 4.*k**2*q*x**2 + q**3*(1. - 4.*x**2) + 2.*k*q**2*(x + 2.*x**3))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(2.*q*Rfid**2*(q - 1.*k*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2)),(0.0036186137015120634*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q*(k**2 + 2.*q**2 - 2.*k*q*x)*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),0.0036186137015120634*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**3*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)),(0.007237227403024127*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**2*(q - 1.*k*x)*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),(0.0036186137015120634*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**3*(2.*q**2 - 4.*k*q*x + k**2*(-1. + 3.*x**2))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),(0.0017006802721088435*k**2*sigfid*((-196.*(1. + b10fid + b01fid*k**2)**2*P(k))/(qmax - 1.*qmin) - (0.10132118364233778*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(2.*q*Rfid**2*(q - 1.*k*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2)),(0.00510204081632653*Rfid*((-196.*k**2*(1. + b10fid + b01fid*k**2)**2*P(k))/(qmax - 1.*qmin) - (0.10132118364233778*(k**2 + 2.*q**2 - 2.*k*q*x)*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(2.*q*Rfid**2*(q - 1.*k*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2))))[param.index(par)]

###### bispectrum derivative ######
def DB_integrand(k,q,x,(fnlfid ,b10fid, b20fid, b01fid, b11fid, b02fid, chi1fid, w10fid, sigfid, Rfid),par):
        return np.asarray(((0.5*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*Fshape(k[0],k[1],k[2]))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*(3.*Rfid**2 + sigfid**2))*(qmax - 1.*qmin)) - 0.00006461810181271541*q*((-1.*(1. + b10fid + b01fid*k[0]**2)*(((-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k[1]**5*x - 14.*k[1]*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k[1]**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k[1]**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k[1]**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*Fshape(k[1],q,np.sqrt(k[1]**2 + q**2 - 2.*k[1]*q*x)))/(2.718281828459045**(0.5*Rfid**2*(k[0]**2 + 2.*(k[1]**2 + q**2 - 1.*k[1]*q*x)))*k[1]**2*(k[1]**2 + q**2 - 2.*k[1]*q*x)) + ((2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k[2]**5*x - 14.*k[2]*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k[2]**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k[2]**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k[2]**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*Fshape(k[2],q,np.sqrt(k[2]**2 + q**2 - 2.*k[2]*q*x)))/(2.718281828459045**(0.5*Rfid**2*(k[0]**2 + 2.*(k[2]**2 + q**2 - 1.*k[2]*q*x)))*k[2]**2*(k[2]**2 + q**2 - 2.*k[2]*q*x)))*P(k[0]))/(2.718281828459045**(0.5*k[0]**2*Rfid**2)*k[0]**2) - (1.*(1. + b10fid + b01fid*k[1]**2)*(((-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k[0]**5*x - 14.*k[0]*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k[0]**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k[0]**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k[0]**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*Fshape(k[0],q,np.sqrt(k[0]**2 + q**2 - 2.*k[0]*q*x)))/(2.718281828459045**(0.5*Rfid**2*(2.*k[0]**2 + k[1]**2 + 2.*q**2 - 2.*k[0]*q*x))*k[0]**2*(k[0]**2 + q**2 - 2.*k[0]*q*x)) + ((-2.*k[2]**4*(5. + 7.*b10fid + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. - 7.*b10fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b10fid + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k[2]**5*x - 14.*k[2]*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k[2]**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k[2]**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k[2]**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*Fshape(k[2],q,np.sqrt(k[2]**2 + q**2 - 2.*k[2]*q*x)))/(2.718281828459045**(0.5*Rfid**2*(k[1]**2 + 2.*(k[2]**2 + q**2 - 1.*k[2]*q*x)))*k[2]**2*(k[2]**2 + q**2 - 2.*k[2]*q*x)))*P(k[1]))/(2.718281828459045**(0.5*k[1]**2*Rfid**2)*k[1]**2) - (1.*(1. + b10fid + b01fid*k[2]**2)*(((2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k[0]**5*x - 14.*k[0]*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k[0]**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k[0]**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k[0]**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*Fshape(k[0],q,np.sqrt(k[0]**2 + q**2 - 2.*k[0]*q*x)))/(2.718281828459045**(0.5*Rfid**2*(2.*k[0]**2 + k[2]**2 + 2.*q**2 - 2.*k[0]*q*x))*k[0]**2*(k[0]**2 + q**2 - 2.*k[0]*q*x)) + ((-2.*k[2]**4*(5. + 7.*b10fid + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. - 7.*b10fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b10fid + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k[1]**5*x - 14.*k[1]*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k[1]**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k[1]**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k[1]**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*Fshape(k[1],q,np.sqrt(k[1]**2 + q**2 - 2.*k[1]*q*x)))/(2.718281828459045**(0.5*Rfid**2*(2.*k[1]**2 + k[2]**2 + 2.*q**2 - 2.*k[1]*q*x))*k[1]**2*(k[1]**2 + q**2 - 2.*k[1]*q*x)))*P(k[2]))/(2.718281828459045**(0.5*k[2]**2*Rfid**2)*k[2]**2)),(0.017857142857142856*((-14.*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*(k[0]**4 + k[1]**4 - 1.*k[1]**2*k[2]**2 - 1.*k[0]**2*(2.*k[1]**2 + k[2]**2))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[0]**2*k[1]**2) + ((1. + b10fid + b01fid*k[0]**2)*(-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[0]**2*k[1]**2) + ((1. + b10fid + b01fid*k[1]**2)*(-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[0]**2*k[1]**2) - (14.*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[2]**2)*(k[0]**4 - 1.*k[1]**2*k[2]**2 + k[2]**4 - 1.*k[0]**2*(k[1]**2 + 2.*k[2]**2))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[0]**2*k[2]**2) + ((1. + b10fid + b01fid*k[0]**2)*(2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[0]**2*k[2]**2) + ((1. + b10fid + b01fid*k[2]**2)*(2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[0]**2*k[2]**2) - (14.*(1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*((k[1]**2 - 1.*k[2]**2)**2 - 1.*k[0]**2*(k[1]**2 + k[2]**2))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2*k[2]**2) + ((1. + b10fid + b01fid*k[1]**2)*(-2.*k[2]**4*(5. + 7.*b10fid + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. - 7.*b10fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b10fid + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2*k[2]**2) + ((1. + b10fid + b01fid*k[2]**2)*(-2.*k[2]**4*(5. + 7.*b10fid + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. - 7.*b10fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b10fid + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2*k[2]**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(0.5*(((1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*P(k[0])*P(k[1]))/2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2) + ((1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[0])*P(k[2]))/2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2) + ((1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[1])*P(k[2]))/2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(0.017857142857142856*((-14.*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*(k[0]**6 - 1.*k[0]**2*k[1]**4 + k[1]**6 - 1.*k[1]**4*k[2]**2 - 1.*k[0]**4*(k[1]**2 + k[2]**2))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[0]**2*k[1]**2) + ((1. + b10fid + b01fid*k[0]**2)*(-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[0]**2) + ((1. + b10fid + b01fid*k[1]**2)*(-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[1]**2) - (14.*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[2]**2)*(k[0]**6 - 1.*k[0]**2*k[2]**4 - 1.*k[1]**2*k[2]**4 + k[2]**6 - 1.*k[0]**4*(k[1]**2 + k[2]**2))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[0]**2*k[2]**2) + ((1. + b10fid + b01fid*k[0]**2)*(2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[0]**2) + ((1. + b10fid + b01fid*k[2]**2)*(2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[2]**2) - (14.*(1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*((k[1]**2 - 1.*k[2]**2)**2*(k[1]**2 + k[2]**2) - 1.*k[0]**2*(k[1]**4 + k[2]**4))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2*k[2]**2) + ((1. + b10fid + b01fid*k[1]**2)*(-2.*k[2]**4*(5. + 7.*b10fid + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. - 7.*b10fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b10fid + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2) + ((1. + b10fid + b01fid*k[2]**2)*(-2.*k[2]**4*(5. + 7.*b10fid + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. - 7.*b10fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b10fid + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[2]**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(0.5*(((1. + b10fid + b01fid*k[0]**2)*(k[0]**2 + k[1]**2)*(1. + b10fid + b01fid*k[1]**2)*P(k[0])*P(k[1]))/2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2) + ((1. + b10fid + b01fid*k[0]**2)*(k[0]**2 + k[2]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[0])*P(k[2]))/2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2) + ((1. + b10fid + b01fid*k[1]**2)*(k[1]**2 + k[2]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[1])*P(k[2]))/2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(0.5*((k[0]**2*(1. + b10fid + b01fid*k[0]**2)*k[1]**2*(1. + b10fid + b01fid*k[1]**2)*P(k[0])*P(k[1]))/2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2) + (k[0]**2*(1. + b10fid + b01fid*k[0]**2)*k[2]**2*(1. + b10fid + b01fid*k[2]**2)*P(k[0])*P(k[2]))/2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2) + (k[1]**2*(1. + b10fid + b01fid*k[1]**2)*k[2]**2*(1. + b10fid + b01fid*k[2]**2)*P(k[1])*P(k[2]))/2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(0.5*(((1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*(k[0]**2 + k[1]**2 - 1.*k[2]**2)*P(k[0])*P(k[1]))/2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2) + ((1. + b10fid + b01fid*k[0]**2)*(k[0]**2 - 1.*k[1]**2 + k[2]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[0])*P(k[2]))/2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2) + ((1. + b10fid + b01fid*k[1]**2)*(-1.*k[0]**2 + k[1]**2 + k[2]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[1])*P(k[2]))/2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(0.125*(((1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*(3.*k[0]**4 + 2.*k[0]**2*(k[1]**2 - 3.*k[2]**2) + 3.*(k[1]**2 - 1.*k[2]**2)**2)*P(k[0])*P(k[1]))/2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2) + ((1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[2]**2)*(3.*k[0]**4 + 3.*(k[1]**2 - 1.*k[2]**2)**2 + k[0]**2*(-6.*k[1]**2 + 2.*k[2]**2))*P(k[0])*P(k[2]))/2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2) + ((1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*(3.*k[0]**4 + 3.*k[1]**4 + 2.*k[1]**2*k[2]**2 + 3.*k[2]**4 - 6.*k[0]**2*(k[1]**2 + k[2]**2))*P(k[1])*P(k[2]))/2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(-0.005952380952380952*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid*(((1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*(-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[0]**2*k[1]**2) + ((1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[2]**2)*(2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[0]**2*k[2]**2) + ((1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*(-2.*k[2]**4*(5. + 7.*b10fid + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. - 7.*b10fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b10fid + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2*k[2]**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(0.017857142857142856*((-2.*(1. + b10fid + b01fid*k[0]**2)*(k[0]**2 + k[1]**2)*(1. + b10fid + b01fid*k[1]**2)*Rfid*(-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[0]**2*k[1]**2) - (2.*(1. + b10fid + b01fid*k[0]**2)*(k[0]**2 + k[2]**2)*(1. + b10fid + b01fid*k[2]**2)*Rfid*(2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[0]**2*k[2]**2) - (2.*(1. + b10fid + b01fid*k[1]**2)*(k[1]**2 + k[2]**2)*(1. + b10fid + b01fid*k[2]**2)*Rfid*(-2.*k[2]**4*(5. + 7.*b10fid + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. - 7.*b10fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b10fid + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2*k[2]**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin))))[param.index(par)]

###### SQUEEZED power spectrum derivative ######
def DP_sq_integrand(k,q,x,(fnlfid ,b10fid, b20fid, b01fid, b11fid, b02fid, chi1fid, w10fid, sigfid, Rfid),bng,par):
    return np.asarray(((-1.2*bng*(1. + b10fid + b01fid*k**2)*P(k))/(2.718281828459045**(0.16666666666666666*k**2*(3.*Rfid**2 + 2.*sigfid**2))*(qmax - 1.*qmin)*T(k)),(0.03571428571428571*((28.*(1. + b10fid + b01fid*k**2)*P(k))/(qmax - 1.*qmin) + (0.10132118364233778*k**2*(q + k*x - 2.*q*x**2)*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(2.*q*Rfid**2*(q - 1.*k*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2)),(0.0036186137015120634*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),(0.03571428571428571*k**2*((28.*(1. + b10fid + b01fid*k**2)*P(k))/(qmax - 1.*qmin) + (0.10132118364233778*(k**3*x - 4.*k**2*q*x**2 + q**3*(1. - 4.*x**2) + 2.*k*q**2*(x + 2.*x**3))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(2.*q*Rfid**2*(q - 1.*k*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2)),(0.0036186137015120634*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q*(k**2 + 2.*q**2 - 2.*k*q*x)*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),0.0036186137015120634*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**3*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)),(0.007237227403024127*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**2*(q - 1.*k*x)*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),(0.0036186137015120634*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**3*(2.*q**2 - 4.*k*q*x + k**2*(-1. + 3.*x**2))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),(0.0017006802721088435*k**2*sigfid*((-196.*(1. + b10fid + b01fid*k**2)**2*P(k))/(qmax - 1.*qmin) - (0.10132118364233778*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(2.*q*Rfid**2*(q - 1.*k*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2)),(0.00510204081632653*Rfid*((-196.*k**2*(1. + b10fid + b01fid*k**2)**2*P(k))/(qmax - 1.*qmin) - (0.10132118364233778*(k**2 + 2.*q**2 - 2.*k*q*x)*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(2.*q*Rfid**2*(q - 1.*k*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2))))[param.index(par)]

###### integrands for systematic shifts solutions  P ######

def a_integrand(k,q,x,(fnlfid ,b10fid, b20fid, b01fid, b11fid, b02fid, chi1fid, w10fid, sigfid, Rfid),index):
    return np.asarray(((0.125*((4.*P(k))/(2.718281828459045**(1.*k**2*Rfid**2)*(qmax - 1.*qmin)) + (0.10132118364233778*k**4*(q + k*x - 2.*q*x**2)**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(1.*Rfid**2*(k**2 + 2.*q**2 - 2.*k*q*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*sigfid**2),0.012665147955292222*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)),(0.125*((4.*k**4*P(k))/(2.718281828459045**(1.*k**2*Rfid**2)*(qmax - 1.*qmin)) + (0.10132118364233778*k**4*(q**3 + k**3*x + 2.*k*q**2*x - 4.*k**2*q*x**2 - 4.*q**3*x**2 + 4.*k*q**2*x**3)**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(1.*Rfid**2*(k**2 + 2.*q**2 - 2.*k*q*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*sigfid**2),0.012665147955292222*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**2*(k**2 + 2.*q**2 - 2.*k*q*x)**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)),0.012665147955292222*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**6*(k**2 + q**2 - 2.*k*q*x)**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)),0.05066059182116889*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**4*(q - 1.*k*x)**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)),0.012665147955292222*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**6*(-1.*k**2 + 2.*q**2 - 4.*k*q*x + 3.*k**2*x**2)**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x))))[index]

def b_integrand(k,q,x,(fnlfid ,b10fid, b20fid, b01fid, b11fid, b02fid, chi1fid, w10fid, sigfid, Rfid),index):
    return np.asarray(((0.125*((8.*(1. + b01fid*k**2)*P(k))/(2.718281828459045**(1.*k**2*Rfid**2)*(qmax - 1.*qmin)) + (0.0041355585160137865*(7.*k**3*x + k**2*q*(7. - 14.*x**2))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + 7.*k**3*x*(1. + 2.*b01fid*q**2 - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid + 4.*b01fid*q**2*x**2 - 6.*q**4*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(1.*Rfid**2*(k**2 + 2.*q**2 - 2.*k*q*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*sigfid**2),(0.0018093068507560317*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q*(7.*b20fid*q**3 + 28.*b11fid*q**5 + 28.*chi1fid*q**5 + 14.*b02fid*q**7 + 28.*q**7*w10fid + 14.*b01fid*k**5*x - 14.*b20fid*k*q**2*x - 84.*b11fid*k*q**4*x - 84.*chi1fid*k*q**4*x - 56.*b02fid*k*q**6*x - 112.*k*q**6*w10fid*x - 7.*b20fid*(k**2*q + q**3 - 2.*k*q**2*x) + 14.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(6. + 14.*b10fid + 7.*b20fid + 14.*b01fid*q**2 + 42.*b11fid*q**2 + 28.*chi1fid*q**2 + 28.*b02fid*q**4 + 14.*q**4*w10fid - 20.*x**2 - 28.*b10fid*x**2 - 56.*b01fid*q**2*x**2 + 56.*b11fid*q**2*x**2 + 56.*chi1fid*q**2*x**2 + 56.*b02fid*q**4*x**2 + 154.*q**4*w10fid*x**2) + 14.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),(0.125*((8.*(1. + b10fid)*k**2*P(k))/(2.718281828459045**(1.*k**2*Rfid**2)*(qmax - 1.*qmin)) + (0.028948909612096507*(k**2*q**3 + k**5*x + 2.*k**3*q**2*x - 4.*k**4*q*x**2 - 4.*k**2*q**3*x**2 + 4.*k**3*q**2*x**3)*(3.*k**2*q + 7.*b10fid*k**2*q + 7.*b20fid*k**2*q + 7.*b11fid*k**4*q + 7.*b20fid*q**3 + 21.*b11fid*k**2*q**3 + 14.*chi1fid*k**2*q**3 + 7.*b02fid*k**4*q**3 + 14.*b11fid*q**5 + 14.*chi1fid*q**5 + 14.*b02fid*k**2*q**5 + 7.*b02fid*q**7 - 7.*k**4*q**3*w10fid + 7.*k**2*q**5*w10fid + 14.*q**7*w10fid + 7.*k**3*x + 7.*b10fid*k**3*x - 14.*b20fid*k*q**2*x - 28.*b11fid*k**3*q**2*x - 14.*chi1fid*k**3*q**2*x - 42.*b11fid*k*q**4*x - 42.*chi1fid*k*q**4*x - 28.*b02fid*k**3*q**4*x - 28.*b02fid*k*q**6*x - 14.*k**3*q**4*w10fid*x - 56.*k*q**6*w10fid*x - 10.*k**2*q*x**2 - 14.*b10fid*k**2*q*x**2 + 28.*b11fid*k**2*q**3*x**2 + 28.*chi1fid*k**2*q**3*x**2 + 28.*b02fid*k**2*q**5*x**2 + 21.*k**4*q**3*w10fid*x**2 + 77.*k**2*q**5*w10fid*x**2 - 42.*k**3*q**4*w10fid*x**3)*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(1.*Rfid**2*(k**2 + 2.*q**2 - 2.*k*q*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*sigfid**2),(0.0036186137015120634*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q*(k**2 + 2.*q**2 - 2.*k*q*x)*(3.*k**2*q + 7.*b10fid*k**2*q + 7.*b20fid*k**2*q + 7.*b20fid*q**3 + 7.*b01fid*k**2*q**3 + 14.*chi1fid*k**2*q**3 + 7.*b02fid*k**4*q**3 + 14.*chi1fid*q**5 + 14.*b02fid*k**2*q**5 + 7.*b02fid*q**7 - 7.*k**4*q**3*w10fid + 7.*k**2*q**5*w10fid + 14.*q**7*w10fid + 7.*k**3*x + 7.*b10fid*k**3*x + 7.*b01fid*k**5*x - 14.*b20fid*k*q**2*x + 14.*b01fid*k**3*q**2*x - 14.*chi1fid*k**3*q**2*x - 42.*chi1fid*k*q**4*x - 28.*b02fid*k**3*q**4*x - 28.*b02fid*k*q**6*x - 14.*k**3*q**4*w10fid*x - 56.*k*q**6*w10fid*x - 10.*k**2*q*x**2 - 14.*b10fid*k**2*q*x**2 - 28.*b01fid*k**4*q*x**2 - 28.*b01fid*k**2*q**3*x**2 + 28.*chi1fid*k**2*q**3*x**2 + 28.*b02fid*k**2*q**5*x**2 + 21.*k**4*q**3*w10fid*x**2 + 77.*k**2*q**5*w10fid*x**2 + 28.*b01fid*k**3*q**2*x**3 - 42.*k**3*q**4*w10fid*x**3)*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),0.0036186137015120634*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**3*(3.*k**2*q + 7.*b10fid*k**2*q + 7.*b20fid*k**2*q + 7.*b11fid*k**4*q + 7.*b20fid*q**3 + 7.*b01fid*k**2*q**3 + 21.*b11fid*k**2*q**3 + 14.*chi1fid*k**2*q**3 + 14.*b11fid*q**5 + 14.*chi1fid*q**5 - 7.*k**4*q**3*w10fid + 7.*k**2*q**5*w10fid + 14.*q**7*w10fid + 7.*k**3*x + 7.*b10fid*k**3*x + 7.*b01fid*k**5*x - 14.*b20fid*k*q**2*x + 14.*b01fid*k**3*q**2*x - 28.*b11fid*k**3*q**2*x - 14.*chi1fid*k**3*q**2*x - 42.*b11fid*k*q**4*x - 42.*chi1fid*k*q**4*x - 14.*k**3*q**4*w10fid*x - 56.*k*q**6*w10fid*x - 10.*k**2*q*x**2 - 14.*b10fid*k**2*q*x**2 - 28.*b01fid*k**4*q*x**2 - 28.*b01fid*k**2*q**3*x**2 + 28.*b11fid*k**2*q**3*x**2 + 28.*chi1fid*k**2*q**3*x**2 + 21.*k**4*q**3*w10fid*x**2 + 77.*k**2*q**5*w10fid*x**2 + 28.*b01fid*k**3*q**2*x**3 - 42.*k**3*q**4*w10fid*x**3)*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)),(0.007237227403024127*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**2*(q - 1.*k*x)*(7.*(b20fid*q**3 + 2.*b11fid*q**5 + chi1fid*q**5 + b02fid*q**7 + 2.*q**7*w10fid) + 7.*b01fid*k**5*x - 14.*b20fid*k*q**2*x - 42.*b11fid*k*q**4*x - 21.*chi1fid*k*q**4*x - 28.*b02fid*k*q**6*x - 56.*k*q**6*w10fid*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + 7.*k**3*x*(1. + b10fid + 2.*b01fid*q**2 - 4.*b11fid*q**2 - 1.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid + 4.*b01fid*q**2*x**2 - 6.*q**4*w10fid*x**2) + k**2*q*(3. + 7.*b10fid + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 7.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 14.*b10fid*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 14.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2) - 1.*chi1fid*(7.*q**5 - 7.*k**3*q**2*x - 21.*k*q**4*x + 7.*k**2*q*(q**2 + 2.*q**2*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),(0.0036186137015120634*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**3*(-1.*k**2 + 2.*q**2 - 4.*k*q*x + 3.*k**2*x**2)*(3.*k**2*q + 7.*b10fid*k**2*q + 7.*b20fid*k**2*q + 7.*b11fid*k**4*q + 7.*b20fid*q**3 + 7.*b01fid*k**2*q**3 + 21.*b11fid*k**2*q**3 + 14.*chi1fid*k**2*q**3 + 7.*b02fid*k**4*q**3 + 14.*b11fid*q**5 + 14.*chi1fid*q**5 + 14.*b02fid*k**2*q**5 + 7.*b02fid*q**7 + 7.*k**3*x + 7.*b10fid*k**3*x + 7.*b01fid*k**5*x - 14.*b20fid*k*q**2*x + 14.*b01fid*k**3*q**2*x - 28.*b11fid*k**3*q**2*x - 14.*chi1fid*k**3*q**2*x - 42.*b11fid*k*q**4*x - 42.*chi1fid*k*q**4*x - 28.*b02fid*k**3*q**4*x - 28.*b02fid*k*q**6*x - 10.*k**2*q*x**2 - 14.*b10fid*k**2*q*x**2 - 28.*b01fid*k**4*q*x**2 - 28.*b01fid*k**2*q**3*x**2 + 28.*b11fid*k**2*q**3*x**2 + 28.*chi1fid*k**2*q**3*x**2 + 28.*b02fid*k**2*q**5*x**2 + 28.*b01fid*k**3*q**2*x**3)*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x)))[index]

def c_integrand(k,q,x,(fnlfid ,b10fid, b20fid, b01fid, b11fid, b02fid, chi1fid, w10fid, sigfid, Rfid),index):
    return np.asarray(((0.125*((4.*(1. + b01fid*k**2)**2*P(k))/(2.718281828459045**(1.*k**2*Rfid**2)*(qmax - 1.*qmin)) - (4.*(1. + b10fid + b01fid*k**2)**2*P(k))/(2.718281828459045**(1.*k**2*Rfid**2)*(qmax - 1.*qmin)) + (0.0020677792580068933*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + 7.*b01fid*q**2*(1. - 4.*x**2)) + 7.*k**3*x*(1. - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(1.*Rfid**2*(k**2 + 2.*q**2 - 2.*k*q*x))*(k**2 + q**2 - 2.*k*q*x)**2) - (0.0020677792580068933*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(1.*Rfid**2*(k**2 + 2.*q**2 - 2.*k*q*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*sigfid**2),(-0.0018093068507560317*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*b20fid*q*(7.*q**3*(b20fid + 2.*q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 14.*b01fid*k**5*x - 14.*k*q**2*(b20fid + 2.*q**2*(3.*b11fid + 3.*chi1fid + 2.*b02fid*q**2 + 4.*q**2*w10fid))*x + 14.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + 14.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)) + k**2*q*(7.*b20fid + b10fid*(14. - 28.*x**2) + 2.*(3. + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),(0.125*((4.*(1. + b10fid)**2*P(k))/(2.718281828459045**(1.*k**2*Rfid**2)*(qmax - 1.*qmin)) - (4.*(1. + b10fid + b01fid*k**2)**2*P(k))/(2.718281828459045**(1.*k**2*Rfid**2)*(qmax - 1.*qmin)) - (0.0020677792580068933*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(1.*Rfid**2*(k**2 + 2.*q**2 - 2.*k*q*x))*(k**2 + q**2 - 2.*k*q*x)**2) + (0.0020677792580068933*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x - 7.*k**3*x*(-1. - 1.*b10fid + 4.*b11fid*q**2 + 2.*chi1fid*q**2 + 4.*b02fid*q**4 + 2.*q**4*w10fid + 6.*q**4*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**4*q*(b11fid + q**2*(b02fid + w10fid*(-1. + 3.*x**2))))**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(1.*Rfid**2*(k**2 + 2.*q**2 - 2.*k*q*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*sigfid**2),(-0.0018093068507560317*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*b11fid*q*(k**2 + 2.*q**2 - 2.*k*q*x)*(14.*q**3*(b20fid + q**2*(b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 14.*b01fid*k**5*x - 14.*k*q**2*(2.*b20fid + q**2*(3.*b11fid + 6.*chi1fid + 4.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + 2.*b02fid*q**2 - 2.*q**2*w10fid - 8.*b01fid*x**2 + 6.*q**2*w10fid*x**2) + k**2*q*(6. + 14.*b20fid + 14.*b01fid*q**2 + 21.*b11fid*q**2 + 28.*chi1fid*q**2 + 28.*b02fid*q**4 + 14.*q**4*w10fid - 20.*x**2 - 56.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 56.*chi1fid*q**2*x**2 + 56.*b02fid*q**4*x**2 + 154.*q**4*w10fid*x**2 + b10fid*(14. - 28.*x**2)) + 14.*k**3*x*(1. + b10fid - 2.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),-0.0018093068507560317*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*b02fid*q**3*(7.*(2.*b20fid*q**3 + q**5*(4.*b11fid + 4.*chi1fid + q**2*(b02fid + 4.*w10fid))) + 14.*b01fid*k**5*x - 28.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + q**2*(b02fid + 4.*w10fid)))*x + 7.*k**4*q*(2.*b11fid + b02fid*q**2 - 2.*q**2*w10fid - 8.*b01fid*x**2 + 6.*q**2*w10fid*x**2) + 2.*k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 7.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 14.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 14.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 2.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)),(-0.007237227403024127*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*chi1fid*q**2*(q - 1.*k*x)*(7.*q**3*(b20fid + q**2*(2.*b11fid + chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 7.*k*q**2*(2.*b20fid + q**2*(6.*b11fid + 3.*chi1fid + 4.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 7.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 14.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 1.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),(-0.0018093068507560317*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**3*w10fid*(2.*q**2 - 4.*k*q*x + k**2*(-1. + 3.*x**2))*(14.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + w10fid))) + 14.*b01fid*k**5*x - 28.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + w10fid)))*x + 7.*k**4*q*(2.*b11fid + 2.*b02fid*q**2 - 1.*q**2*w10fid - 8.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(6. + 14.*b20fid + 14.*b01fid*q**2 + 42.*b11fid*q**2 + 28.*chi1fid*q**2 + 28.*b02fid*q**4 + 7.*q**4*w10fid - 20.*x**2 - 56.*b01fid*q**2*x**2 + 56.*b11fid*q**2*x**2 + 56.*chi1fid*q**2*x**2 + 56.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(14. - 28.*x**2)) + 14.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 1.*q**4*w10fid - 3.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x)))[index]


###### integrands for systematic shifts solutions  B ######

def a0_integrand(k,q,x,(fnlfid ,b10fid, b20fid, b01fid, b11fid, b02fid, chi1fid, w10fid, sigfid, Rfid),index):
    return np.asarray(((0.017857142857142856*((2.718281828459045**((-1.*k[0]**2 - 1.*k[1]**2)*Rfid**2)*(1. + b01fid*k[0]**2)*(1. + b01fid*k[1]**2)*(-2.*(k[1]**2 - 1.*k[2]**2)*(5.*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) + 2.*k[0]**4*(-5. + 14.*b11fid*k[1]**2 + 14.*chi1fid*k[1]**2 + 14.*b02fid*k[1]**4 + 7.*b01fid*(k[1]**2 + k[2]**2) + 7.*k[1]**4*w10fid - 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(6.*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(k[0]**2*k[1]**2) - (1.*2.718281828459045**((-1.*k[0]**2 - 1.*k[1]**2)*Rfid**2)*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*(-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(k[0]**2*k[1]**2) + (2.718281828459045**((-1.*k[0]**2 - 1.*k[2]**2)*Rfid**2)*(1. + b01fid*k[0]**2)*(1. + b01fid*k[2]**2)*(2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + 5.*k[2]**2 + 7.*b01fid*k[2]**4) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + 2.*k[0]**4*(-5. + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*b01fid*(k[1]**2 + k[2]**2) - 21.*k[1]**2*k[2]**2*w10fid + 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + k[1]**2*(6. - 28.*chi1fid*k[2]**2 - 42.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(k[0]**2*k[2]**2) - (1.*2.718281828459045**((-1.*k[0]**2 - 1.*k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[2]**2)*(2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(k[0]**2*k[2]**2) + (2.718281828459045**((-1.*k[1]**2 - 1.*k[2]**2)*Rfid**2)*(1. + b01fid*k[1]**2)*(1. + b01fid*k[2]**2)*(-2.*k[2]**4*(5. + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(k[1]**2*k[2]**2) - (1.*2.718281828459045**((-1.*k[1]**2 - 1.*k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*(-2.*k[2]**4*(5. + 7.*b10fid + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. - 7.*b10fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b10fid + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(k[1]**2*k[2]**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(-0.5*b20fid*(2.718281828459045**((2.*k[0]**2 + k[1]**2 + k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[1])*P(k[2]) + 2.718281828459045**((k[0]**2 + k[1]**2 + k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[0]**2)*P(k[0])*(2.718281828459045**(k[2]**2*Rfid**2)*(1. + b10fid + b01fid*k[1]**2)*P(k[1]) + 2.718281828459045**(k[1]**2*Rfid**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[2]))))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*(12.*Rfid**2 + sigfid**2))*(qmax - 1.*qmin)),(0.017857142857142856*((-1.*2.718281828459045**((-1.*k[0]**2 - 1.*k[1]**2)*Rfid**2)*(1. + b10fid)**2*(2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 2.*k[2]**2) - 21.*k[0]**6*k[1]**2*w10fid + 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) - 1.*k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(k[0]**2*k[1]**2) - (1.*2.718281828459045**((-1.*k[0]**2 - 1.*k[1]**2)*Rfid**2)*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*(-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(k[0]**2*k[1]**2) - (1.*2.718281828459045**((-1.*k[0]**2 - 1.*k[2]**2)*Rfid**2)*(1. + b10fid)**2*(-2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + (5. + 7.*b10fid)*k[2]**2) - 21.*k[0]**6*k[2]**2*w10fid + 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) - 1.*k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(k[0]**2*k[2]**2) - (1.*2.718281828459045**((-1.*k[0]**2 - 1.*k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[2]**2)*(2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(k[0]**2*k[2]**2) + (2.718281828459045**((-1.*k[1]**2 - 1.*k[2]**2)*Rfid**2)*(1. + b10fid)**2*(-2.*(5. + 7.*b10fid)*k[2]**4 + 21.*k[1]**6*k[2]**2*w10fid + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. - 7.*b10fid + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*((3. + 7.*b10fid)*k[2]**2 - 21.*k[1]**4*k[2]**2*w10fid + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(k[1]**2*k[2]**2) - (1.*2.718281828459045**((-1.*k[1]**2 - 1.*k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*(-2.*k[2]**4*(5. + 7.*b10fid + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. - 7.*b10fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b10fid + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(k[1]**2*k[2]**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(-0.5*b11fid*(2.718281828459045**((2.*k[0]**2 + k[1]**2 + k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[1]**2)*(k[1]**2 + k[2]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[1])*P(k[2]) + 2.718281828459045**((k[0]**2 + k[1]**2 + k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[0]**2)*P(k[0])*(2.718281828459045**(k[2]**2*Rfid**2)*(k[0]**2 + k[1]**2)*(1. + b10fid + b01fid*k[1]**2)*P(k[1]) + 2.718281828459045**(k[1]**2*Rfid**2)*(k[0]**2 + k[2]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[2]))))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*(12.*Rfid**2 + sigfid**2))*(qmax - 1.*qmin)),(-0.5*b02fid*(2.718281828459045**((2.*k[0]**2 + k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2*(1. + b10fid + b01fid*k[1]**2)*k[2]**2*(1. + b10fid + b01fid*k[2]**2)*P(k[1])*P(k[2]) + 2.718281828459045**((k[0]**2 + k[1]**2 + k[2]**2)*Rfid**2)*k[0]**2*(1. + b10fid + b01fid*k[0]**2)*P(k[0])*(2.718281828459045**(k[2]**2*Rfid**2)*k[1]**2*(1. + b10fid + b01fid*k[1]**2)*P(k[1]) + 2.718281828459045**(k[1]**2*Rfid**2)*k[2]**2*(1. + b10fid + b01fid*k[2]**2)*P(k[2]))))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*(12.*Rfid**2 + sigfid**2))*(qmax - 1.*qmin)),(-0.5*chi1fid*(-1.*2.718281828459045**((2.*k[0]**2 + k[1]**2 + k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[1]**2)*(k[0]**2 - 1.*k[1]**2 - 1.*k[2]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[1])*P(k[2]) + (1. + b10fid + b01fid*k[0]**2)*P(k[0])*(2.718281828459045**((k[0]**2 + k[1]**2 + 2.*k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[1]**2)*(k[0]**2 + k[1]**2 - 1.*k[2]**2)*P(k[1]) + 2.718281828459045**((k[0]**2 + 2.*k[1]**2 + k[2]**2)*Rfid**2)*(k[0]**2 - 1.*k[1]**2 + k[2]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[2]))))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*(12.*Rfid**2 + sigfid**2))*(qmax - 1.*qmin)),(0.017857142857142856*((-2.*2.718281828459045**((-1.*k[0]**2 - 1.*k[1]**2)*Rfid**2)*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*(7.*b01fid*k[0]**6 + (k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) + k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2)) - 1.*k[0]**2*(7.*(b01fid + 2.*(b11fid + chi1fid))*k[1]**4 + (3. + 7.*b10fid)*k[2]**2 + 2.*k[1]**2*(5. + 7.*b10fid + 7.*b20fid - 7.*chi1fid*k[2]**2)))*P(k[0])*P(k[1]))/(k[0]**2*k[1]**2) - (1.*2.718281828459045**((-1.*k[0]**2 - 1.*k[1]**2)*Rfid**2)*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*(-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(k[0]**2*k[1]**2) - (2.*2.718281828459045**((-1.*k[0]**2 - 1.*k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[2]**2)*(7.*b01fid*k[0]**6 + k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2)) - 1.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 1.*k[0]**2*(k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2) + k[2]**2*(10. + 14.*b10fid + 14.*b20fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2)))*P(k[0])*P(k[2]))/(k[0]**2*k[2]**2) - (1.*2.718281828459045**((-1.*k[0]**2 - 1.*k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[2]**2)*(2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(k[0]**2*k[2]**2) - (2.*2.718281828459045**((-1.*k[1]**2 - 1.*k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*(-2.*k[0]**4 + 7.*b01fid*k[1]**6 + k[2]**4*(5. + 7.*b10fid + 7.*b01fid*k[2]**2) - 1.*k[1]**2*k[2]**2*(10. + 14.*b10fid + 14.*b20fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2) + k[1]**4*(5. + 7.*b10fid - 7.*b01fid*k[2]**2 - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4) - 1.*k[0]**2*(7.*b01fid*k[1]**4 + k[2]**2*(3. + 7.*b10fid + 7.*b01fid*k[2]**2) + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2)))*P(k[1])*P(k[2]))/(k[1]**2*k[2]**2) - (1.*2.718281828459045**((-1.*k[1]**2 - 1.*k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*(-2.*k[2]**4*(5. + 7.*b10fid + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. - 7.*b10fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b10fid + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(k[1]**2*k[2]**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin))))[index]

def a1_integrand(k,q,x,(fnlfid ,b10fid, b20fid, b01fid, b11fid, b02fid, chi1fid, w10fid, sigfid, Rfid),index):
    return np.asarray(((0.017857142857142856*((2.718281828459045**((-1.*k[0]**2 - 1.*k[1]**2)*Rfid**2)*(-14.*(1. + b01fid*k[0]**2)*(1. + b01fid*k[1]**2)*(k[0]**4 + k[1]**4 - 1.*k[1]**2*k[2]**2 - 1.*k[0]**2*(2.*k[1]**2 + k[2]**2)) + (2. + b01fid*(k[0]**2 + k[1]**2))*(-2.*(k[1]**2 - 1.*k[2]**2)*(5.*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) + 2.*k[0]**4*(-5. + 14.*b11fid*k[1]**2 + 14.*chi1fid*k[1]**2 + 14.*b02fid*k[1]**4 + 7.*b01fid*(k[1]**2 + k[2]**2) + 7.*k[1]**4*w10fid - 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(6.*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid))))*P(k[0])*P(k[1]))/(k[0]**2*k[1]**2) + (2.718281828459045**((-1.*k[0]**2 - 1.*k[2]**2)*Rfid**2)*(-14.*(1. + b01fid*k[0]**2)*(1. + b01fid*k[2]**2)*(k[0]**4 - 1.*k[1]**2*k[2]**2 + k[2]**4 - 1.*k[0]**2*(k[1]**2 + 2.*k[2]**2)) + (2. + b01fid*(k[0]**2 + k[2]**2))*(2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + 5.*k[2]**2 + 7.*b01fid*k[2]**4) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + 2.*k[0]**4*(-5. + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*b01fid*(k[1]**2 + k[2]**2) - 21.*k[1]**2*k[2]**2*w10fid + 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + k[1]**2*(6. - 28.*chi1fid*k[2]**2 - 42.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid))))*P(k[0])*P(k[2]))/(k[0]**2*k[2]**2) + (2.718281828459045**((-1.*k[1]**2 - 1.*k[2]**2)*Rfid**2)*(-14.*(1. + b01fid*k[1]**2)*(1. + b01fid*k[2]**2)*((k[1]**2 - 1.*k[2]**2)**2 - 1.*k[0]**2*(k[1]**2 + k[2]**2)) + (2. + b01fid*(k[1]**2 + k[2]**2))*(-2.*k[2]**4*(5. + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid))))*P(k[1])*P(k[2]))/(k[1]**2*k[2]**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(0.5*(2.718281828459045**((2.*k[0]**2 + k[1]**2 + k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[1])*P(k[2]) + 2.718281828459045**((k[0]**2 + k[1]**2 + k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[0]**2)*P(k[0])*(2.718281828459045**(k[2]**2*Rfid**2)*(1. + b10fid + b01fid*k[1]**2)*P(k[1]) + 2.718281828459045**(k[1]**2*Rfid**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[2]))))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*(12.*Rfid**2 + sigfid**2))*(qmax - 1.*qmin)),(0.017857142857142856*(1. + b10fid)*((2.718281828459045**((-1.*k[0]**2 - 1.*k[1]**2)*Rfid**2)*(-14.*(1. + b10fid)*(k[0]**6 - 1.*k[0]**2*k[1]**4 + k[1]**6 - 1.*k[1]**4*k[2]**2 - 1.*k[0]**4*(k[1]**2 + k[2]**2)) + (k[0]**2 + k[1]**2)*(-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 2.*k[2]**2) + 21.*k[0]**6*k[1]**2*w10fid - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid))))*P(k[0])*P(k[1]))/(k[0]**2*k[1]**2) + (2.718281828459045**((-1.*k[0]**2 - 1.*k[2]**2)*Rfid**2)*(-14.*(1. + b10fid)*(k[0]**6 - 1.*k[0]**2*k[2]**4 - 1.*k[1]**2*k[2]**4 + k[2]**6 - 1.*k[0]**4*(k[1]**2 + k[2]**2)) + (k[0]**2 + k[2]**2)*(2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + (5. + 7.*b10fid)*k[2]**2) + 21.*k[0]**6*k[2]**2*w10fid - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid))))*P(k[0])*P(k[2]))/(k[0]**2*k[2]**2) + (2.718281828459045**((-1.*k[1]**2 - 1.*k[2]**2)*Rfid**2)*(k[0]**4*(k[1]**2 + k[2]**2)*(4. + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(4.*(5. + 7.*b10fid)*k[2]**4 - 42.*k[1]**6*k[2]**2*w10fid + 2.*k[1]**2*k[2]**2*(6. + 14.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + 4.*k[1]**4*(5. + 7.*b10fid - 7.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)) + (k[1]**2 + k[2]**2)*(-4.*(6. + 7.*b10fid)*k[2]**4 + 21.*k[1]**6*k[2]**2*w10fid + k[1]**4*(-24. - 28.*b10fid + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 28.*b02fid*k[2]**4 + 14.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(48. + 56.*b10fid + 28.*b20fid + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(k[1]**2*k[2]**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(0.5*(2.718281828459045**((2.*k[0]**2 + k[1]**2 + k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[1]**2)*(k[1]**2 + k[2]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[1])*P(k[2]) + 2.718281828459045**((k[0]**2 + k[1]**2 + k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[0]**2)*P(k[0])*(2.718281828459045**(k[2]**2*Rfid**2)*(k[0]**2 + k[1]**2)*(1. + b10fid + b01fid*k[1]**2)*P(k[1]) + 2.718281828459045**(k[1]**2*Rfid**2)*(k[0]**2 + k[2]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[2]))))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*(12.*Rfid**2 + sigfid**2))*(qmax - 1.*qmin)),(0.5*(2.718281828459045**((2.*k[0]**2 + k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2*(1. + b10fid + b01fid*k[1]**2)*k[2]**2*(1. + b10fid + b01fid*k[2]**2)*P(k[1])*P(k[2]) + 2.718281828459045**((k[0]**2 + k[1]**2 + k[2]**2)*Rfid**2)*k[0]**2*(1. + b10fid + b01fid*k[0]**2)*P(k[0])*(2.718281828459045**(k[2]**2*Rfid**2)*k[1]**2*(1. + b10fid + b01fid*k[1]**2)*P(k[1]) + 2.718281828459045**(k[1]**2*Rfid**2)*k[2]**2*(1. + b10fid + b01fid*k[2]**2)*P(k[2]))))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*(12.*Rfid**2 + sigfid**2))*(qmax - 1.*qmin)),(0.5*(2.718281828459045**((-1.*k[0]**2 - 1.*k[1]**2)*Rfid**2)*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*(k[0]**2 + k[1]**2 - 1.*k[2]**2)*P(k[0])*P(k[1]) + 2.718281828459045**((-1.*k[0]**2 - 1.*k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[0]**2)*(k[0]**2 - 1.*k[1]**2 + k[2]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[0])*P(k[2]) + 2.718281828459045**((-1.*k[1]**2 - 1.*k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[1]**2)*(-1.*k[0]**2 + k[1]**2 + k[2]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[1])*P(k[2])))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(0.125*(2.718281828459045**((-1.*k[0]**2 - 1.*k[1]**2)*Rfid**2)*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*(3.*k[0]**4 + 2.*k[0]**2*(k[1]**2 - 3.*k[2]**2) + 3.*(k[1]**2 - 1.*k[2]**2)**2)*P(k[0])*P(k[1]) + 2.718281828459045**((-1.*k[0]**2 - 1.*k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[2]**2)*(3.*k[0]**4 + 3.*(k[1]**2 - 1.*k[2]**2)**2 + k[0]**2*(-6.*k[1]**2 + 2.*k[2]**2))*P(k[0])*P(k[2]) + 2.718281828459045**((-1.*k[1]**2 - 1.*k[2]**2)*Rfid**2)*(1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*(3.*k[0]**4 + 3.*k[1]**4 + 2.*k[1]**2*k[2]**2 + 3.*k[2]**4 - 6.*k[0]**2*(k[1]**2 + k[2]**2))*P(k[1])*P(k[2])))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin))))[index]

def a2_integrand(k,q,x,(fnlfid ,b10fid, b20fid, b01fid, b11fid, b02fid, chi1fid, w10fid, sigfid, Rfid),index):
    return np.asarray(((0.017857142857142856*(((-2.*(k[1]**2 - 1.*k[2]**2)*(19.*k[1]**2 + 14.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(4.*b01fid - 3.*k[1]**2*w10fid) + 2.*k[0]**4*(-19. + 14.*b11fid*k[1]**2 + 14.*chi1fid*k[1]**2 + 14.*b02fid*k[1]**4 + 14.*b01fid*(k[1]**2 + k[2]**2) + 7.*k[1]**4*w10fid - 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(34.*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(2.*b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(76. + 28.*b20fid + 28.*b01fid*k[2]**2 - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[0]**2*k[1]**2) + ((2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + 19.*k[2]**2 + 14.*b01fid*k[2]**4) - 7.*k[0]**6*(4.*b01fid - 3.*k[2]**2*w10fid) + 2.*k[0]**4*(-19. + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 14.*b01fid*(k[1]**2 + k[2]**2) - 21.*k[1]**2*k[2]**2*w10fid + 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + k[1]**2*(34. + 28.*b01fid*k[2]**2 - 28.*chi1fid*k[2]**2 - 42.*k[2]**4*w10fid) + k[2]**2*(76. + 28.*b20fid + 28.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[0]**2*k[2]**2) + ((-2.*k[2]**4*(19. + 14.*b01fid*k[2]**2) - 7.*k[1]**6*(4.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-19. + 14.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(76. + 28.*b20fid + 28.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + k[0]**2*(34.*k[2]**2 + 28.*b01fid*k[2]**4 + 14.*k[1]**4*(2.*b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(34. + 28.*b01fid*k[2]**2 - 28.*chi1fid*k[2]**2 - 42.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2*k[2]**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),0.,(0.017857142857142856*(((-14.*(1. + b10fid)*k[1]**6*(k[1]**2 - 1.*k[2]**2) + k[0]**2*(-2.*(5. + 7.*b10fid)*k[1]**6 + 4.*(5. + 7.*b10fid)*k[1]**4*k[2]**2 + 4.*k[1]**2*k[2]**4) - 7.*k[0]**8*(2. + 2.*b10fid - 3.*k[1]**4*w10fid) + 2.*k[0]**6*(-1.*(5. + 7.*b10fid)*k[1]**2 + 7.*(1. + b10fid)*k[2]**2 + 7.*k[1]**6*(2.*b02fid + w10fid) + 7.*k[1]**4*(2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid)) + k[0]**4*k[1]**2*(4.*(5. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(48. + 56.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[0]**2*k[1]**2) + ((14.*(1. + b10fid)*k[2]**6*(k[1]**2 - 1.*k[2]**2) + 2.*k[0]**2*(2.*k[1]**4*k[2]**2 + 2.*(5. + 7.*b10fid)*k[1]**2*k[2]**4 - 1.*(5. + 7.*b10fid)*k[2]**6) - 7.*k[0]**8*(2. + 2.*b10fid - 3.*k[2]**4*w10fid) + 2.*k[0]**6*(7.*k[1]**2*(1. + b10fid - 3.*k[2]**4*w10fid) + k[2]**2*(-5. - 7.*b10fid + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid)) + k[0]**4*k[2]**2*(21.*k[1]**4*k[2]**2*w10fid + k[1]**2*(20. + 28.*b10fid - 28.*chi1fid*k[2]**2 - 42.*k[2]**4*w10fid) + k[2]**2*(48. + 56.*b10fid + 28.*b20fid + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[0]**2*k[2]**2) + ((-2.*(5. + 7.*b10fid)*k[1]**2*k[2]**6 - 14.*(1. + b10fid)*k[2]**8 + k[0]**4*k[1]**2*k[2]**2*(4. + 21.*k[1]**2*k[2]**2*w10fid) - 7.*k[1]**8*(2. + 2.*b10fid - 3.*k[2]**4*w10fid) + 2.*k[1]**6*k[2]**2*(-5. - 7.*b10fid + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**4*k[2]**4*(48. + 56.*b10fid + 28.*b20fid + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(2.*(5. + 7.*b10fid)*k[1]**2*k[2]**4 + 7.*(1. + b10fid)*k[2]**6 + k[1]**4*k[2]**2*(10. + 14.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + 7.*k[1]**6*(1. + b10fid - 3.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2*k[2]**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),0.,0.,0.,0.))[index]

def a3_integrand(k,q,x,(fnlfid ,b10fid, b20fid, b01fid, b11fid, b02fid, chi1fid, w10fid, sigfid, Rfid),index):
    return np.asarray(((0.25*((-1.*(k[0]**4 + k[1]**4 - 1.*k[1]**2*k[2]**2 - 1.*k[0]**2*(2.*k[1]**2 + k[2]**2))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[0]**2*k[1]**2) - (1.*(k[0]**4 - 1.*k[1]**2*k[2]**2 + k[2]**4 - 1.*k[0]**2*(k[1]**2 + 2.*k[2]**2))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[0]**2*k[2]**2) + ((-1.*(k[1]**2 - 1.*k[2]**2)**2 + k[0]**2*(k[1]**2 + k[2]**2))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2*k[2]**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),0.,(0.25*((-1.*(k[0]**6 - 1.*k[0]**2*k[1]**4 + k[1]**6 - 1.*k[1]**4*k[2]**2 - 1.*k[0]**4*(k[1]**2 + k[2]**2))*P(k[0])*P(k[1]))/2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2) - (1.*(k[0]**6 - 1.*k[0]**2*k[2]**4 - 1.*k[1]**2*k[2]**4 + k[2]**6 - 1.*k[0]**4*(k[1]**2 + k[2]**2))*P(k[0])*P(k[2]))/2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2) + ((-1.*(k[1]**2 - 1.*k[2]**2)**2*(k[1]**2 + k[2]**2) + k[0]**2*(k[1]**4 + k[2]**4))*P(k[1])*P(k[2]))/2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),0.,0.,0.,0.))[index]


# gives the factors a , b, c for when shifting pairs of parameters appaering in bng. sovlve for the 1st of the 2 parameters.
# {{b01, b11}, {b01, b02}, {b01, chi1}, {b01, w10}, {b11, b02}, {b11,chi1}, {b11, w10}, {b02, chi1}, {b02, w10},{chi1, w10}}
def double_shift_abc(bng,sigma0,sigma1,sigma2,b20, b11, b02, chi1, w10,Fx,ax,bx,cx,Fy,ay,by,cy,index):
    return np.asarray(((ax*Fx + (ay*Fy*sigma0**4)/(4.*sigma1**4),bx*Fx - (Fy*sigma0**2*(ay*bng + by*sigma1**2 - 2*ay*chi1*sigma1**2 - ay*b02*sigma2**2 - 2*ay*sigma2**2*w10))/(2.*sigma1**4),cx*Fx + Fy*(cy + (ay*(bng - 2*chi1*sigma1**2 - b02*sigma2**2 - 2*sigma2**2*w10)**2)/(4.*sigma1**4) + (bng*by - 2*by*chi1*sigma1**2 - b02*by*sigma2**2 - 2*by*sigma2**2*w10)/(2.*sigma1**2))),(ax*Fx + (ay*Fy*sigma0**4)/sigma2**4,bx*Fx - (Fy*sigma0**2*(2*ay*bng - 4*ay*b11*sigma1**2 - 4*ay*chi1*sigma1**2 + by*sigma2**2 - 4*ay*sigma2**2*w10))/sigma2**4,cx*Fx + Fy*(cy + (ay*(bng - 2*b11*sigma1**2 - 2*chi1*sigma1**2 - 2*sigma2**2*w10)**2)/sigma2**4 + (bng*by - 2*b11*by*sigma1**2 - 2*by*chi1*sigma1**2 - 2*by*sigma2**2*w10)/sigma2**2)),(ax*Fx + (ay*Fy*sigma0**4)/(4.*sigma1**4),bx*Fx - (Fy*sigma0**2*(ay*bng - 2*ay*b11*sigma1**2 + by*sigma1**2 - ay*b02*sigma2**2 - 2*ay*sigma2**2*w10))/(2.*sigma1**4),cx*Fx + Fy*(cy + (ay*(bng - 2*b11*sigma1**2 - b02*sigma2**2 - 2*sigma2**2*w10)**2)/(4.*sigma1**4) + (bng*by - 2*b11*by*sigma1**2 - b02*by*sigma2**2 - 2*by*sigma2**2*w10)/(2.*sigma1**2))),(ax*Fx + (ay*Fy*sigma0**4)/(4.*sigma2**4),bx*Fx - (Fy*sigma0**2*(ay*bng - 2*ay*b11*sigma1**2 - 2*ay*chi1*sigma1**2 - ay*b02*sigma2**2 + by*sigma2**2))/(2.*sigma2**4),cx*Fx + Fy*(cy + (ay*(bng - 2*b11*sigma1**2 - 2*chi1*sigma1**2 - b02*sigma2**2)**2)/(4.*sigma2**4) + (bng*by - 2*b11*by*sigma1**2 - 2*by*chi1*sigma1**2 - b02*by*sigma2**2)/(2.*sigma2**2))),(ax*Fx + (4*ay*Fy*sigma1**4)/sigma2**4,bx*Fx - (2*Fy*sigma1**2*(2*ay*bng - 2*ay*b20*sigma0**2 - 4*ay*chi1*sigma1**2 + by*sigma2**2 - 4*ay*sigma2**2*w10))/sigma2**4,cx*Fx + Fy*(cy + (ay*(bng - b20*sigma0**2 - 2*chi1*sigma1**2 - 2*sigma2**2*w10)**2)/sigma2**4 + (bng*by - b20*by*sigma0**2 - 2*by*chi1*sigma1**2 - 2*by*sigma2**2*w10)/sigma2**2)),(ax*Fx + ay*Fy,bx*Fx + Fy*(-by - (ay*(bng - b20*sigma0**2 - b02*sigma2**2 - 2*sigma2**2*w10))/sigma1**2),cx*Fx + Fy*(cy + (by*(bng - b20*sigma0**2 - b02*sigma2**2 - 2*sigma2**2*w10))/(2.*sigma1**2) + (ay*(bng - b20*sigma0**2 - b02*sigma2**2 - 2*sigma2**2*w10)**2)/(4.*sigma1**4))),(ax*Fx + (ay*Fy*sigma1**4)/sigma2**4,bx*Fx - (Fy*sigma1**2*(ay*bng - ay*b20*sigma0**2 - 2*ay*chi1*sigma1**2 - ay*b02*sigma2**2 + by*sigma2**2))/sigma2**4,cx*Fx + Fy*(cy + (ay*(bng - b20*sigma0**2 - 2*chi1*sigma1**2 - b02*sigma2**2)**2)/(4.*sigma2**4) + (bng*by - b20*by*sigma0**2 - 2*by*chi1*sigma1**2 - b02*by*sigma2**2)/(2.*sigma2**2))),(ax*Fx + (ay*Fy*sigma2**4)/(4.*sigma1**4),bx*Fx - (Fy*sigma2**2*(ay*bng - ay*b20*sigma0**2 - 2*ay*b11*sigma1**2 + by*sigma1**2 - 2*ay*sigma2**2*w10))/(2.*sigma1**4),cx*Fx + Fy*(cy + (ay*(bng - b20*sigma0**2 - 2*b11*sigma1**2 - 2*sigma2**2*w10)**2)/(4.*sigma1**4) + (bng*by - b20*by*sigma0**2 - 2*b11*by*sigma1**2 - 2*by*sigma2**2*w10)/(2.*sigma1**2))),(ax*Fx + (ay*Fy)/4.,bx*Fx + Fy*(-by/2. - (ay*(bng - b20*sigma0**2 - 2*b11*sigma1**2 - 2*chi1*sigma1**2))/(2.*sigma2**2)),cx*Fx + Fy*(cy + (ay*(bng - b20*sigma0**2 - 2*b11*sigma1**2 - 2*chi1*sigma1**2)**2)/(4.*sigma2**4) + (by*(bng - b20*sigma0**2 - 2*b11*sigma1**2 - 2*chi1*sigma1**2))/(2.*sigma2**2))),(ax*Fx + (ay*Fy*sigma1**4)/sigma2**4,bx*Fx - (Fy*sigma1**2*(ay*bng - ay*b20*sigma0**2 - 2*ay*b11*sigma1**2 - ay*b02*sigma2**2 + by*sigma2**2))/sigma2**4,cx*Fx + Fy*(cy + (ay*(bng - b20*sigma0**2 - 2*b11*sigma1**2 - b02*sigma2**2)**2)/(4.*sigma2**4) + (bng*by - b20*by*sigma0**2 - 2*b11*by*sigma1**2 - b02*by*sigma2**2)/(2.*sigma2**2)))))[index]

def double_shift_a0123(bng,sigma0,sigma1,sigma2,b20,b11,b02,chi1,w10,Fx,a0x,a1x,a2x,a3x,Fy,a0y,a1y,a2y,a3y,index):
    return np.asarray(((a3x*Fx - (a3y*Fy*sigma0**6)/(8.*sigma1**6),a2x*Fx + (Fy*sigma0**4*(3*a3y*bng + 2*a2y*sigma1**2 - 6*a3y*chi1*sigma1**2 - 3*a3y*b02*sigma2**2 - 6*a3y*sigma2**2*w10))/(8.*sigma1**6),a1x*Fx + Fy*(-(a1y*sigma0**2)/(2.*sigma1**2) - (a2y*sigma0**2*(bng - 2*chi1*sigma1**2 - b02*sigma2**2 - 2*sigma2**2*w10))/(2.*sigma1**4) - (3*a3y*sigma0**2*(bng - 2*chi1*sigma1**2 - b02*sigma2**2 - 2*sigma2**2*w10)**2)/(8.*sigma1**6)),a0x*Fx + Fy*(a0y + (a2y*(bng - 2*chi1*sigma1**2 - b02*sigma2**2 - 2*sigma2**2*w10)**2)/(4.*sigma1**4) + (a3y*(bng - 2*chi1*sigma1**2 - b02*sigma2**2 - 2*sigma2**2*w10)**3)/(8.*sigma1**6) + (a1y*bng - 2*a1y*chi1*sigma1**2 - a1y*b02*sigma2**2 - 2*a1y*sigma2**2*w10)/(2.*sigma1**2))),(a3x*Fx - (a3y*Fy*sigma0**6)/sigma2**6,a2x*Fx + (Fy*sigma0**4*(3*a3y*bng - 6*a3y*b11*sigma1**2 - 6*a3y*chi1*sigma1**2 + a2y*sigma2**2 - 6*a3y*sigma2**2*w10))/sigma2**6,a1x*Fx + Fy*(-((a1y*sigma0**2)/sigma2**2) - (2*a2y*sigma0**2*(bng - 2*b11*sigma1**2 - 2*chi1*sigma1**2 - 2*sigma2**2*w10))/sigma2**4 - (3*a3y*sigma0**2*(bng - 2*b11*sigma1**2 - 2*chi1*sigma1**2 - 2*sigma2**2*w10)**2)/sigma2**6),a0x*Fx + Fy*(a0y + (a2y*(bng - 2*b11*sigma1**2 - 2*chi1*sigma1**2 - 2*sigma2**2*w10)**2)/sigma2**4 + (a3y*(bng - 2*b11*sigma1**2 - 2*chi1*sigma1**2 - 2*sigma2**2*w10)**3)/sigma2**6 + (a1y*bng - 2*a1y*b11*sigma1**2 - 2*a1y*chi1*sigma1**2 - 2*a1y*sigma2**2*w10)/sigma2**2)),(a3x*Fx - (a3y*Fy*sigma0**6)/(8.*sigma1**6),a2x*Fx + (Fy*sigma0**4*(3*a3y*bng + 2*a2y*sigma1**2 - 6*a3y*b11*sigma1**2 - 3*a3y*b02*sigma2**2 - 6*a3y*sigma2**2*w10))/(8.*sigma1**6),a1x*Fx + Fy*(-(a1y*sigma0**2)/(2.*sigma1**2) - (a2y*sigma0**2*(bng - 2*b11*sigma1**2 - b02*sigma2**2 - 2*sigma2**2*w10))/(2.*sigma1**4) - (3*a3y*sigma0**2*(bng - 2*b11*sigma1**2 - b02*sigma2**2 - 2*sigma2**2*w10)**2)/(8.*sigma1**6)),a0x*Fx + Fy*(a0y + (a2y*(bng - 2*b11*sigma1**2 - b02*sigma2**2 - 2*sigma2**2*w10)**2)/(4.*sigma1**4) + (a3y*(bng - 2*b11*sigma1**2 - b02*sigma2**2 - 2*sigma2**2*w10)**3)/(8.*sigma1**6) + (a1y*bng - 2*a1y*b11*sigma1**2 - a1y*b02*sigma2**2 - 2*a1y*sigma2**2*w10)/(2.*sigma1**2))),(a3x*Fx - (a3y*Fy*sigma0**6)/(8.*sigma2**6),a2x*Fx + (Fy*sigma0**4*(3*a3y*bng - 6*a3y*b11*sigma1**2 - 6*a3y*chi1*sigma1**2 + 2*a2y*sigma2**2 - 3*a3y*b02*sigma2**2))/(8.*sigma2**6),a1x*Fx + Fy*(-(a1y*sigma0**2)/(2.*sigma2**2) - (a2y*sigma0**2*(bng - 2*b11*sigma1**2 - 2*chi1*sigma1**2 - b02*sigma2**2))/(2.*sigma2**4) - (3*a3y*sigma0**2*(bng - 2*b11*sigma1**2 - 2*chi1*sigma1**2 - b02*sigma2**2)**2)/(8.*sigma2**6)),a0x*Fx + Fy*(a0y + (a2y*(bng - 2*b11*sigma1**2 - 2*chi1*sigma1**2 - b02*sigma2**2)**2)/(4.*sigma2**4) + (a3y*(bng - 2*b11*sigma1**2 - 2*chi1*sigma1**2 - b02*sigma2**2)**3)/(8.*sigma2**6) + (a1y*bng - 2*a1y*b11*sigma1**2 - 2*a1y*chi1*sigma1**2 - a1y*b02*sigma2**2)/(2.*sigma2**2))),(a3x*Fx - (8*a3y*Fy*sigma1**6)/sigma2**6,a2x*Fx + (4*Fy*sigma1**4*(3*a3y*bng - 3*a3y*b20*sigma0**2 - 6*a3y*chi1*sigma1**2 + a2y*sigma2**2 - 6*a3y*sigma2**2*w10))/sigma2**6,a1x*Fx + Fy*((-2*a1y*sigma1**2)/sigma2**2 - (4*a2y*sigma1**2*(bng - b20*sigma0**2 - 2*chi1*sigma1**2 - 2*sigma2**2*w10))/sigma2**4 - (6*a3y*sigma1**2*(bng - b20*sigma0**2 - 2*chi1*sigma1**2 - 2*sigma2**2*w10)**2)/sigma2**6),a0x*Fx + Fy*(a0y + (a2y*(bng - b20*sigma0**2 - 2*chi1*sigma1**2 - 2*sigma2**2*w10)**2)/sigma2**4 + (a3y*(bng - b20*sigma0**2 - 2*chi1*sigma1**2 - 2*sigma2**2*w10)**3)/sigma2**6 + (a1y*bng - a1y*b20*sigma0**2 - 2*a1y*chi1*sigma1**2 - 2*a1y*sigma2**2*w10)/sigma2**2)),(a3x*Fx - a3y*Fy,a2x*Fx + Fy*(a2y + (3*a3y*(bng - b20*sigma0**2 - b02*sigma2**2 - 2*sigma2**2*w10))/(2.*sigma1**2)),a1x*Fx + Fy*(-a1y - (a2y*(bng - b20*sigma0**2 - b02*sigma2**2 - 2*sigma2**2*w10))/sigma1**2 - (3*a3y*(bng - b20*sigma0**2 - b02*sigma2**2 - 2*sigma2**2*w10)**2)/(4.*sigma1**4)),a0x*Fx + Fy*(a0y + (a1y*(bng - b20*sigma0**2 - b02*sigma2**2 - 2*sigma2**2*w10))/(2.*sigma1**2) + (a2y*(bng - b20*sigma0**2 - b02*sigma2**2 - 2*sigma2**2*w10)**2)/(4.*sigma1**4) + (a3y*(bng - b20*sigma0**2 - b02*sigma2**2 - 2*sigma2**2*w10)**3)/(8.*sigma1**6))),(a3x*Fx - (a3y*Fy*sigma1**6)/sigma2**6,a2x*Fx + Fy*((a2y*sigma1**4)/sigma2**4 + (3*a3y*sigma1**4*(bng - b20*sigma0**2 - 2*chi1*sigma1**2 - b02*sigma2**2))/(2.*sigma2**6)),a1x*Fx + Fy*(-((a1y*sigma1**2)/sigma2**2) - (3*a3y*sigma1**2*(bng - b20*sigma0**2 - 2*chi1*sigma1**2 - b02*sigma2**2)**2)/(4.*sigma2**6) + (a2y*sigma1**2*(-bng + b20*sigma0**2 + 2*chi1*sigma1**2 + b02*sigma2**2))/sigma2**4),a0x*Fx + Fy*(a0y + (a2y*(bng - b20*sigma0**2 - 2*chi1*sigma1**2 - b02*sigma2**2)**2)/(4.*sigma2**4) + (a3y*(bng - b20*sigma0**2 - 2*chi1*sigma1**2 - b02*sigma2**2)**3)/(8.*sigma2**6) + (a1y*bng - a1y*b20*sigma0**2 - 2*a1y*chi1*sigma1**2 - a1y*b02*sigma2**2)/(2.*sigma2**2))),(a3x*Fx - (a3y*Fy*sigma2**6)/(8.*sigma1**6),a2x*Fx + (Fy*sigma2**4*(3*a3y*bng - 3*a3y*b20*sigma0**2 + 2*a2y*sigma1**2 - 6*a3y*b11*sigma1**2 - 6*a3y*sigma2**2*w10))/(8.*sigma1**6),a1x*Fx + Fy*(-(a1y*sigma2**2)/(2.*sigma1**2) - (a2y*sigma2**2*(bng - b20*sigma0**2 - 2*b11*sigma1**2 - 2*sigma2**2*w10))/(2.*sigma1**4) - (3*a3y*sigma2**2*(bng - b20*sigma0**2 - 2*b11*sigma1**2 - 2*sigma2**2*w10)**2)/(8.*sigma1**6)),a0x*Fx + Fy*(a0y + (a2y*(bng - b20*sigma0**2 - 2*b11*sigma1**2 - 2*sigma2**2*w10)**2)/(4.*sigma1**4) + (a3y*(bng - b20*sigma0**2 - 2*b11*sigma1**2 - 2*sigma2**2*w10)**3)/(8.*sigma1**6) + (a1y*bng - a1y*b20*sigma0**2 - 2*a1y*b11*sigma1**2 - 2*a1y*sigma2**2*w10)/(2.*sigma1**2))),(a3x*Fx - (a3y*Fy)/8.,a2x*Fx + Fy*(a2y/4. + (3*a3y*(bng - b20*sigma0**2 - 2*b11*sigma1**2 - 2*chi1*sigma1**2))/(8.*sigma2**2)),a1x*Fx + Fy*(-a1y/2. - (3*a3y*(bng - b20*sigma0**2 - 2*b11*sigma1**2 - 2*chi1*sigma1**2)**2)/(8.*sigma2**4) - (a2y*(bng - b20*sigma0**2 - 2*b11*sigma1**2 - 2*chi1*sigma1**2))/(2.*sigma2**2)),a0x*Fx + Fy*(a0y + (a3y*(bng - b20*sigma0**2 - 2*b11*sigma1**2 - 2*chi1*sigma1**2)**3)/(8.*sigma2**6) + (a2y*(bng - b20*sigma0**2 - 2*b11*sigma1**2 - 2*chi1*sigma1**2)**2)/(4.*sigma2**4) + (a1y*(bng - b20*sigma0**2 - 2*b11*sigma1**2 - 2*chi1*sigma1**2))/(2.*sigma2**2))),(a3x*Fx - (a3y*Fy*sigma1**6)/sigma2**6,a2x*Fx + Fy*((a2y*sigma1**4)/sigma2**4 + (3*a3y*sigma1**4*(bng - b20*sigma0**2 - 2*b11*sigma1**2 - b02*sigma2**2))/(2.*sigma2**6)),a1x*Fx + Fy*(-((a1y*sigma1**2)/sigma2**2) - (3*a3y*sigma1**2*(bng - b20*sigma0**2 - 2*b11*sigma1**2 - b02*sigma2**2)**2)/(4.*sigma2**6) + (a2y*sigma1**2*(-bng + b20*sigma0**2 + 2*b11*sigma1**2 + b02*sigma2**2))/sigma2**4),a0x*Fx + Fy*(a0y + (a2y*(bng - b20*sigma0**2 - 2*b11*sigma1**2 - b02*sigma2**2)**2)/(4.*sigma2**4) + (a3y*(bng - b20*sigma0**2 - 2*b11*sigma1**2 - b02*sigma2**2)**3)/(8.*sigma2**6) + (a1y*bng - a1y*b20*sigma0**2 - 2*a1y*b11*sigma1**2 - a1y*b02*sigma2**2)/(2.*sigma2**2)))))[index]

##gives value of the second parameter as function of the shift in the first for each combination. replace 1st parameter by its shifted value

# def parameter_y(bng,sigma0,sigma1,sigma2,b20, b11, b02, chi1, w10,index):
#     return asarray(((bng - b20*sigma0**2 - 2*chi1*sigma1**2 - b02*sigma2**2 - 2*sigma2**2*w10)/(2.*sigma1**2),(bng - b20*sigma0**2 - 2*b11*sigma1**2 - 2*chi1*sigma1**2 - 2*sigma2**2*w10)/sigma2**2,(bng - b20*sigma0**2 - 2*b11*sigma1**2 - b02*sigma2**2 - 2*sigma2**2*w10)/(2.*sigma1**2),(bng - b20*sigma0**2 - 2*b11*sigma1**2 - 2*chi1*sigma1**2 - b02*sigma2**2)/(2.*sigma2**2),(bng - b20*sigma0**2 - 2*b11*sigma1**2 - 2*chi1*sigma1**2 - 2*sigma2**2*w10)/sigma2**2,(bng - b20*sigma0**2 - 2*b11*sigma1**2 - b02*sigma2**2 - 2*sigma2**2*w10)/(2.*sigma1**2),(bng - b20*sigma0**2 - 2*b11*sigma1**2 - 2*chi1*sigma1**2 - b02*sigma2**2)/(2.*sigma2**2),(bng - b20*sigma0**2 - 2*b11*sigma1**2 - b02*sigma2**2 - 2*sigma2**2*w10)/(2.*sigma1**2),(bng - b20*sigma0**2 - 2*b11*sigma1**2 - 2*chi1*sigma1**2 - b02*sigma2**2)/(2.*sigma2**2),(bng - b20*sigma0**2 - 2*b11*sigma1**2 - 2*chi1*sigma1**2 - b02*sigma2**2)/(2.*sigma2**2)))[index]
