import numpy as np
from fishfun import P, qmin, qmax, Fshape, allparam, T

param = allparam # ugly but no choice for now 

###### power spectrum ######
def P_integrand(k,q,x,(fnlfid ,b10fid, b20fid, b01fid, b11fid, b02fid, chi1fid, w10fid, sigfid, Rfid)):
    return (0.002551020408163265*((196.*(1. + b10fid + b01fid*k**2)**2*P(k))/(qmax - 1.*qmin) + (0.10132118364233778*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(2.*q*Rfid**2*(q - 1.*k*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2))


###### bispectrum ######
def B_integrand(k,q,x,(fnlfid ,b10fid, b20fid, b01fid, b11fid, b02fid, chi1fid, w10fid, sigfid, Rfid)):
    return (0.008414,(0.017857142857142856*(((1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*(-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 14.*k[0]**6*(1.*b01fid - 1.5*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*((6. + 14.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + k[1]**4*(14.*b01fid + 28.*b11fid + 28.*chi1fid - 42.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[0]**2*k[1]**2) + ((1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[2]**2)*(2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 14.*k[0]**6*(1.*b01fid - 1.5*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + k[1]**2*(6. + 14.*b10fid - 28.*chi1fid*k[2]**2 - 42.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[0]**2*k[2]**2) - (14.*(1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*(k[2]**4*(0.7142857142857143 + 1.*b10fid + 1.*b01fid*k[2]**2) + k[1]**6*(1.*b01fid - 1.5*k[2]**2*w10fid) + k[0]**4*(-0.2857142857142857 - 1.5*k[1]**2*k[2]**2*w10fid) + k[1]**2*k[2]**2*(-1.4285714285714286 - 2.*b10fid - 2.*b20fid - 1.*b01fid*k[2]**2 - 2.*b11fid*k[2]**2 - 2.*chi1fid*k[2]**2 - 1.5*k[2]**4*w10fid) + k[1]**4*(0.7142857142857143 + 1.*b10fid - 1.*b01fid*k[2]**2 - 2.*b11fid*k[2]**2 - 2.*chi1fid*k[2]**2 - 2.*b02fid*k[2]**4 - 1.*k[2]**4*w10fid) + k[0]**2*(k[2]**2*(-0.42857142857142855 - 1.*b10fid - 1.*b01fid*k[2]**2) + k[1]**4*(-1.*b01fid + 3.*k[2]**2*w10fid) + k[1]**2*(-0.42857142857142855 - 1.*b10fid + 2.*chi1fid*k[2]**2 + 3.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2*k[2]**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)))

###### power spectrum derivative ######
def DP_integrand(k,q,x,(fnlfid ,b10fid, b20fid, b01fid, b11fid, b02fid, chi1fid, w10fid, sigfid, Rfid),par):
    return np.asarray(((0.0036186137015120634*2.718281828459045**(-1.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + k*q*Rfid**2*x)*(1. + b10fid + b01fid*k**2)*q*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*Fshape(q,np.sqrt(k**2 + q**2 - 2.*k*q*x),k))/(k**2 + q**2 - 2.*k*q*x),(0.03571428571428571*((28.*(1. + b10fid + b01fid*k**2)*P(k))/(qmax - 1.*qmin) + (0.10132118364233778*k**2*(q + k*x - 2.*q*x**2)*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(2.*q*Rfid**2*(q - 1.*k*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2)),(0.0036186137015120634*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),(0.03571428571428571*k**2*((28.*(1. + b10fid + b01fid*k**2)*P(k))/(qmax - 1.*qmin) + (0.10132118364233778*(k**3*x - 4.*k**2*q*x**2 + q**3*(1. - 4.*x**2) + 2.*k*q**2*(x + 2.*x**3))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(2.*q*Rfid**2*(q - 1.*k*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2)),(0.0036186137015120634*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q*(k**2 + 2.*q**2 - 2.*k*q*x)*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),0.0036186137015120634*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**3*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)),(0.007237227403024127*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**2*(q - 1.*k*x)*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),(0.0036186137015120634*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**3*(2.*q**2 - 4.*k*q*x + k**2*(-1. + 3.*x**2))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),(0.0017006802721088435*k**2*sigfid*((-196.*(1. + b10fid + b01fid*k**2)**2*P(k))/(qmax - 1.*qmin) - (0.10132118364233778*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(2.*q*Rfid**2*(q - 1.*k*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2)),(0.00510204081632653*Rfid*((-196.*k**2*(1. + b10fid + b01fid*k**2)**2*P(k))/(qmax - 1.*qmin) - (0.10132118364233778*(k**2 + 2.*q**2 - 2.*k*q*x)*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(2.*q*Rfid**2*(q - 1.*k*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2))))[param.index(par)]

###### bispectrum derivative ######
def DB_integrand(k,q,x,(fnlfid ,b10fid, b20fid, b01fid, b11fid, b02fid, chi1fid, w10fid, sigfid, Rfid),par):
        return np.asarray(((0.5*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*Fshape(k[0],k[1],k[2]))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*(3.*Rfid**2 + sigfid**2))*(qmax - 1.*qmin)) - 0.00006461810181271541*q*((-1.*(1. + b10fid + b01fid*k[0]**2)*(((-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k[1]**5*x - 14.*k[1]*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k[1]**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k[1]**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k[1]**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*Fshape(k[1],q,np.sqrt(k[1]**2 + q**2 - 2.*k[1]*q*x)))/(2.718281828459045**(0.5*Rfid**2*(k[0]**2 + 2.*(k[1]**2 + q**2 - 1.*k[1]*q*x)))*k[1]**2*(k[1]**2 + q**2 - 2.*k[1]*q*x)) + ((2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k[2]**5*x - 14.*k[2]*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k[2]**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k[2]**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k[2]**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*Fshape(k[2],q,np.sqrt(k[2]**2 + q**2 - 2.*k[2]*q*x)))/(2.718281828459045**(0.5*Rfid**2*(k[0]**2 + 2.*(k[2]**2 + q**2 - 1.*k[2]*q*x)))*k[2]**2*(k[2]**2 + q**2 - 2.*k[2]*q*x)))*P(k[0]))/(2.718281828459045**(0.5*k[0]**2*Rfid**2)*k[0]**2) - (1.*(1. + b10fid + b01fid*k[1]**2)*(((-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k[0]**5*x - 14.*k[0]*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k[0]**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k[0]**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k[0]**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*Fshape(k[0],q,np.sqrt(k[0]**2 + q**2 - 2.*k[0]*q*x)))/(2.718281828459045**(0.5*Rfid**2*(2.*k[0]**2 + k[1]**2 + 2.*q**2 - 2.*k[0]*q*x))*k[0]**2*(k[0]**2 + q**2 - 2.*k[0]*q*x)) + ((-2.*k[2]**4*(5. + 7.*b10fid + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. - 7.*b10fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b10fid + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k[2]**5*x - 14.*k[2]*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k[2]**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k[2]**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k[2]**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*Fshape(k[2],q,np.sqrt(k[2]**2 + q**2 - 2.*k[2]*q*x)))/(2.718281828459045**(0.5*Rfid**2*(k[1]**2 + 2.*(k[2]**2 + q**2 - 1.*k[2]*q*x)))*k[2]**2*(k[2]**2 + q**2 - 2.*k[2]*q*x)))*P(k[1]))/(2.718281828459045**(0.5*k[1]**2*Rfid**2)*k[1]**2) - (1.*(1. + b10fid + b01fid*k[2]**2)*(((2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k[0]**5*x - 14.*k[0]*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k[0]**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k[0]**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k[0]**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*Fshape(k[0],q,np.sqrt(k[0]**2 + q**2 - 2.*k[0]*q*x)))/(2.718281828459045**(0.5*Rfid**2*(2.*k[0]**2 + k[2]**2 + 2.*q**2 - 2.*k[0]*q*x))*k[0]**2*(k[0]**2 + q**2 - 2.*k[0]*q*x)) + ((-2.*k[2]**4*(5. + 7.*b10fid + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. - 7.*b10fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b10fid + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k[1]**5*x - 14.*k[1]*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k[1]**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k[1]**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k[1]**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*Fshape(k[1],q,np.sqrt(k[1]**2 + q**2 - 2.*k[1]*q*x)))/(2.718281828459045**(0.5*Rfid**2*(2.*k[1]**2 + k[2]**2 + 2.*q**2 - 2.*k[1]*q*x))*k[1]**2*(k[1]**2 + q**2 - 2.*k[1]*q*x)))*P(k[2]))/(2.718281828459045**(0.5*k[2]**2*Rfid**2)*k[2]**2)),(0.017857142857142856*((-14.*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*(k[0]**4 + k[1]**4 - 1.*k[1]**2*k[2]**2 - 1.*k[0]**2*(2.*k[1]**2 + k[2]**2))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[0]**2*k[1]**2) + ((1. + b10fid + b01fid*k[0]**2)*(-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[0]**2*k[1]**2) + ((1. + b10fid + b01fid*k[1]**2)*(-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[0]**2*k[1]**2) - (14.*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[2]**2)*(k[0]**4 - 1.*k[1]**2*k[2]**2 + k[2]**4 - 1.*k[0]**2*(k[1]**2 + 2.*k[2]**2))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[0]**2*k[2]**2) + ((1. + b10fid + b01fid*k[0]**2)*(2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[0]**2*k[2]**2) + ((1. + b10fid + b01fid*k[2]**2)*(2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[0]**2*k[2]**2) - (14.*(1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*((k[1]**2 - 1.*k[2]**2)**2 - 1.*k[0]**2*(k[1]**2 + k[2]**2))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2*k[2]**2) + ((1. + b10fid + b01fid*k[1]**2)*(-2.*k[2]**4*(5. + 7.*b10fid + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. - 7.*b10fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b10fid + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2*k[2]**2) + ((1. + b10fid + b01fid*k[2]**2)*(-2.*k[2]**4*(5. + 7.*b10fid + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. - 7.*b10fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b10fid + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2*k[2]**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(0.5*(((1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*P(k[0])*P(k[1]))/2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2) + ((1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[0])*P(k[2]))/2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2) + ((1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[1])*P(k[2]))/2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(0.017857142857142856*((-14.*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*(k[0]**6 - 1.*k[0]**2*k[1]**4 + k[1]**6 - 1.*k[1]**4*k[2]**2 - 1.*k[0]**4*(k[1]**2 + k[2]**2))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[0]**2*k[1]**2) + ((1. + b10fid + b01fid*k[0]**2)*(-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[0]**2) + ((1. + b10fid + b01fid*k[1]**2)*(-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[1]**2) - (14.*(1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[2]**2)*(k[0]**6 - 1.*k[0]**2*k[2]**4 - 1.*k[1]**2*k[2]**4 + k[2]**6 - 1.*k[0]**4*(k[1]**2 + k[2]**2))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[0]**2*k[2]**2) + ((1. + b10fid + b01fid*k[0]**2)*(2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[0]**2) + ((1. + b10fid + b01fid*k[2]**2)*(2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[2]**2) - (14.*(1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*((k[1]**2 - 1.*k[2]**2)**2*(k[1]**2 + k[2]**2) - 1.*k[0]**2*(k[1]**4 + k[2]**4))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2*k[2]**2) + ((1. + b10fid + b01fid*k[1]**2)*(-2.*k[2]**4*(5. + 7.*b10fid + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. - 7.*b10fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b10fid + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2) + ((1. + b10fid + b01fid*k[2]**2)*(-2.*k[2]**4*(5. + 7.*b10fid + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. - 7.*b10fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b10fid + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[2]**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(0.5*(((1. + b10fid + b01fid*k[0]**2)*(k[0]**2 + k[1]**2)*(1. + b10fid + b01fid*k[1]**2)*P(k[0])*P(k[1]))/2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2) + ((1. + b10fid + b01fid*k[0]**2)*(k[0]**2 + k[2]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[0])*P(k[2]))/2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2) + ((1. + b10fid + b01fid*k[1]**2)*(k[1]**2 + k[2]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[1])*P(k[2]))/2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(0.5*((k[0]**2*(1. + b10fid + b01fid*k[0]**2)*k[1]**2*(1. + b10fid + b01fid*k[1]**2)*P(k[0])*P(k[1]))/2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2) + (k[0]**2*(1. + b10fid + b01fid*k[0]**2)*k[2]**2*(1. + b10fid + b01fid*k[2]**2)*P(k[0])*P(k[2]))/2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2) + (k[1]**2*(1. + b10fid + b01fid*k[1]**2)*k[2]**2*(1. + b10fid + b01fid*k[2]**2)*P(k[1])*P(k[2]))/2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(0.5*(((1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*(k[0]**2 + k[1]**2 - 1.*k[2]**2)*P(k[0])*P(k[1]))/2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2) + ((1. + b10fid + b01fid*k[0]**2)*(k[0]**2 - 1.*k[1]**2 + k[2]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[0])*P(k[2]))/2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2) + ((1. + b10fid + b01fid*k[1]**2)*(-1.*k[0]**2 + k[1]**2 + k[2]**2)*(1. + b10fid + b01fid*k[2]**2)*P(k[1])*P(k[2]))/2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(0.125*(((1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*(3.*k[0]**4 + 2.*k[0]**2*(k[1]**2 - 3.*k[2]**2) + 3.*(k[1]**2 - 1.*k[2]**2)**2)*P(k[0])*P(k[1]))/2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2) + ((1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[2]**2)*(3.*k[0]**4 + 3.*(k[1]**2 - 1.*k[2]**2)**2 + k[0]**2*(-6.*k[1]**2 + 2.*k[2]**2))*P(k[0])*P(k[2]))/2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2) + ((1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*(3.*k[0]**4 + 3.*k[1]**4 + 2.*k[1]**2*k[2]**2 + 3.*k[2]**4 - 6.*k[0]**2*(k[1]**2 + k[2]**2))*P(k[1])*P(k[2]))/2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(-0.005952380952380952*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid*(((1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[1]**2)*(-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[0]**2*k[1]**2) + ((1. + b10fid + b01fid*k[0]**2)*(1. + b10fid + b01fid*k[2]**2)*(2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[0]**2*k[2]**2) + ((1. + b10fid + b01fid*k[1]**2)*(1. + b10fid + b01fid*k[2]**2)*(-2.*k[2]**4*(5. + 7.*b10fid + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. - 7.*b10fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b10fid + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2*k[2]**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin)),(0.017857142857142856*((-2.*(1. + b10fid + b01fid*k[0]**2)*(k[0]**2 + k[1]**2)*(1. + b10fid + b01fid*k[1]**2)*Rfid*(-2.*(k[1]**2 - 1.*k[2]**2)*((5. + 7.*b10fid)*k[1]**2 + 7.*b01fid*k[1]**4 + 2.*k[2]**2) - 7.*k[0]**6*(2.*b01fid - 3.*k[1]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[1]**2 - 14.*chi1fid*k[1]**2 - 14.*b02fid*k[1]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) - 7.*k[1]**4*w10fid + 21.*k[1]**2*k[2]**2*w10fid) + k[0]**2*(2.*(3. + 7.*b10fid)*k[2]**2 + 21.*k[1]**6*w10fid + 14.*k[1]**4*(b01fid + 2.*b11fid + 2.*chi1fid - 3.*k[2]**2*w10fid) + k[1]**2*(20. + 28.*b10fid + 28.*b20fid - 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[1]))/(2.718281828459045**(1.*(k[0]**2 + k[1]**2)*Rfid**2)*k[0]**2*k[1]**2) - (2.*(1. + b10fid + b01fid*k[0]**2)*(k[0]**2 + k[2]**2)*(1. + b10fid + b01fid*k[2]**2)*Rfid*(2.*(k[1]**2 - 1.*k[2]**2)*(2.*k[1]**2 + k[2]**2*(5. + 7.*b10fid + 7.*b01fid*k[2]**2)) - 7.*k[0]**6*(2.*b01fid - 3.*k[2]**2*w10fid) - 2.*k[0]**4*(5. + 7.*b10fid - 14.*b11fid*k[2]**2 - 14.*chi1fid*k[2]**2 - 14.*b02fid*k[2]**4 - 7.*b01fid*(k[1]**2 + k[2]**2) + 21.*k[1]**2*k[2]**2*w10fid - 7.*k[2]**4*w10fid) + k[0]**2*(21.*k[1]**4*k[2]**2*w10fid + 2.*k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid) + k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid)))*P(k[0])*P(k[2]))/(2.718281828459045**(1.*(k[0]**2 + k[2]**2)*Rfid**2)*k[0]**2*k[2]**2) - (2.*(1. + b10fid + b01fid*k[1]**2)*(k[1]**2 + k[2]**2)*(1. + b10fid + b01fid*k[2]**2)*Rfid*(-2.*k[2]**4*(5. + 7.*b10fid + 7.*b01fid*k[2]**2) - 7.*k[1]**6*(2.*b01fid - 3.*k[2]**2*w10fid) + k[0]**4*(4. + 21.*k[1]**2*k[2]**2*w10fid) + 2.*k[1]**4*(-5. - 7.*b10fid + 7.*b01fid*k[2]**2 + 14.*b11fid*k[2]**2 + 14.*chi1fid*k[2]**2 + 14.*b02fid*k[2]**4 + 7.*k[2]**4*w10fid) + k[1]**2*k[2]**2*(20. + 28.*b10fid + 28.*b20fid + 14.*b01fid*k[2]**2 + 28.*b11fid*k[2]**2 + 28.*chi1fid*k[2]**2 + 21.*k[2]**4*w10fid) + 2.*k[0]**2*(k[2]**2*(3. + 7.*b10fid + 7.*b01fid*k[2]**2) + 7.*k[1]**4*(b01fid - 3.*k[2]**2*w10fid) + k[1]**2*(3. + 7.*b10fid - 14.*chi1fid*k[2]**2 - 21.*k[2]**4*w10fid)))*P(k[1])*P(k[2]))/(2.718281828459045**(1.*(k[1]**2 + k[2]**2)*Rfid**2)*k[1]**2*k[2]**2)))/(2.718281828459045**(0.16666666666666666*(k[0]**2 + k[1]**2 + k[2]**2)*sigfid**2)*(qmax - 1.*qmin))))[param.index(par)]

###### SQUEEZED power spectrum derivative ######
def DP_sq_integrand(k,q,x,(fnlfid ,b10fid, b20fid, b01fid, b11fid, b02fid, chi1fid, w10fid, sigfid, Rfid),bng,par):
    return np.asarray(((-1.2*bng*(1. + b10fid + b01fid*k**2)*P(k))/(2.718281828459045**(0.16666666666666666*k**2*(3.*Rfid**2 + 2.*sigfid**2))*(qmax - 1.*qmin)*T(k)),(0.03571428571428571*((28.*(1. + b10fid + b01fid*k**2)*P(k))/(qmax - 1.*qmin) + (0.10132118364233778*k**2*(q + k*x - 2.*q*x**2)*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(2.*q*Rfid**2*(q - 1.*k*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2)),(0.0036186137015120634*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),(0.03571428571428571*k**2*((28.*(1. + b10fid + b01fid*k**2)*P(k))/(qmax - 1.*qmin) + (0.10132118364233778*(k**3*x - 4.*k**2*q*x**2 + q**3*(1. - 4.*x**2) + 2.*k*q**2*(x + 2.*x**3))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(2.*q*Rfid**2*(q - 1.*k*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2)),(0.0036186137015120634*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q*(k**2 + 2.*q**2 - 2.*k*q*x)*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),0.0036186137015120634*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**3*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)),(0.007237227403024127*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**2*(q - 1.*k*x)*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),(0.0036186137015120634*2.718281828459045**(-2.*q**2*Rfid**2 - 0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2) + 2.*k*q*Rfid**2*x)*q**3*(2.*q**2 - 4.*k*q*x + k**2*(-1. + 3.*x**2))*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(k**2 + q**2 - 2.*k*q*x),(0.0017006802721088435*k**2*sigfid*((-196.*(1. + b10fid + b01fid*k**2)**2*P(k))/(qmax - 1.*qmin) - (0.10132118364233778*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(2.*q*Rfid**2*(q - 1.*k*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2)),(0.00510204081632653*Rfid*((-196.*k**2*(1. + b10fid + b01fid*k**2)**2*P(k))/(qmax - 1.*qmin) - (0.10132118364233778*(k**2 + 2.*q**2 - 2.*k*q*x)*(7.*q**3*(b20fid + q**2*(2.*b11fid + 2.*chi1fid + q**2*(b02fid + 2.*w10fid))) + 7.*b01fid*k**5*x - 14.*k*q**2*(b20fid + q**2*(3.*b11fid + 3.*chi1fid + 2.*q**2*(b02fid + 2.*w10fid)))*x + 7.*k**4*q*(b11fid + b02fid*q**2 - 1.*q**2*w10fid - 4.*b01fid*x**2 + 3.*q**2*w10fid*x**2) + k**2*q*(3. + 7.*b20fid + 7.*b01fid*q**2 + 21.*b11fid*q**2 + 14.*chi1fid*q**2 + 14.*b02fid*q**4 + 7.*q**4*w10fid - 10.*x**2 - 28.*b01fid*q**2*x**2 + 28.*b11fid*q**2*x**2 + 28.*chi1fid*q**2*x**2 + 28.*b02fid*q**4*x**2 + 77.*q**4*w10fid*x**2 + b10fid*(7. - 14.*x**2)) + 7.*k**3*x*(1. + b10fid - 4.*b11fid*q**2 - 2.*chi1fid*q**2 - 4.*b02fid*q**4 - 2.*q**4*w10fid - 6.*q**4*w10fid*x**2 + 2.*b01fid*q**2*(1. + 2.*x**2)))**2*P(q)*P(np.sqrt(k**2 + q**2 - 2.*k*q*x)))/(2.718281828459045**(2.*q*Rfid**2*(q - 1.*k*x))*(k**2 + q**2 - 2.*k*q*x)**2)))/2.718281828459045**(0.3333333333333333*k**2*(3.*Rfid**2 + sigfid**2))))[param.index(par)]